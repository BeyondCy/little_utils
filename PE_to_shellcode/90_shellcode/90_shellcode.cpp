// 90_shellcode.cpp : Defines the entry point for the application.
//

#include "stdafx.h"
#include "90_shellcode.h"



int APIENTRY _tWinMain(_In_ HINSTANCE hInstance,
                     _In_opt_ HINSTANCE hPrevInstance,
                     _In_ LPTSTR    lpCmdLine,
                     _In_ int       nCmdShow)
{
    LoadLibraryA("User32.dll");
   
    HANDLE hHeap = HeapCreate(HEAP_CREATE_ENABLE_EXECUTE, 1024, 0);
    PVOID pMem = HeapAlloc(hHeap, HEAP_ZERO_MEMORY, 1024 * 1024);
    pMem = (PVOID)((int)pMem + 16);
    

    //unsigned char shellcode[] =
    //{ 232, 0, 0, 0, 0, 94, 139, 254, 129, 198, 23, 1, 0, 0, 185, 4, 0, 0, 0, 252, 173, 1, 60, 7, 226, 250, 232, 36, 0, 0, 0, 106, 4, 104, 39, 1, 0, 0, 104, 47, 1, 0, 0, 106, 0, 139, 200, 232, 91, 0, 0, 0, 255, 208, 199, 5, 55, 1, 0, 0, 8, 0, 0, 0, 51, 192, 195, 85, 139, 236, 81, 83, 86, 87, 96, 100, 161, 48, 0, 0, 0, 137, 69, 252, 97, 139, 69, 252, 95, 94, 91, 139, 229, 93, 195, 83, 86, 139, 241, 184, 119, 1, 0, 0, 178, 1, 43, 240, 138, 12, 6, 132, 201, 117, 8, 56, 8, 116, 19, 132, 201, 116, 13, 138, 24, 132, 219, 116, 7, 58, 203, 117, 3, 64, 235, 228, 50, 210, 94, 138, 194, 91, 195, 85, 139, 236, 131, 236, 16, 139, 65, 12, 83, 86, 87, 139, 64, 20, 139, 248, 137, 69, 244, 141, 71, 248, 139, 63, 139, 112, 24, 133, 246, 116, 59, 139, 70, 60, 139, 68, 48, 120, 137, 69, 240, 133, 192, 116, 45, 139, 76, 48, 32, 51, 219, 139, 68, 48, 24, 3, 206, 137, 77, 248, 137, 69, 252, 133, 192, 116, 23, 139, 12, 153, 3, 206, 232, 130, 255, 255, 255, 60, 1, 116, 23, 139, 77, 248, 67, 59, 93, 252, 114, 233, 59, 125, 244, 117, 180, 51, 192, 95, 94, 91, 139, 229, 93, 195, 139, 85, 240, 139, 68, 50, 36, 141, 4, 88, 15, 183, 12, 48, 139, 68, 50, 28, 141, 4, 136, 139, 4, 48, 3, 198, 235, 221, 232, 1, 255, 255, 255, 51, 192, 195, 29, 0, 0, 0, 34, 0, 0, 0, 51, 0, 0, 0, 95, 0, 0, 0, 116, 105, 116, 108, 101, 0, 0, 0, 116, 101, 120, 116, 0, 0, 0, 0, 0, 240, 240, 240, 0, 0, 0, 0, 0, 0, 0, 0, 237, 121, 202, 86, 0, 0, 0, 0, 2, 0, 0, 0, 72, 0, 0, 0, 76, 32, 0, 0, 76, 6, 0, 0, 0, 0, 0, 0, 237, 121, 202, 86, 0, 0, 0, 0, 12, 0, 0, 0, 20, 0, 0, 0, 148, 32, 0, 0, 148, 6, 0, 0, 77, 101, 115, 115, 97, 103, 101, 66, 111, 120, 65, 0, 8, 0, 0, 0, 4, 0, 0, 0, 82, 83, 68, 83, 65, 209, 166, 13, 204, 104, 105, 75, 161, 108, 220, 86, 226, 201, 252, 137, 1, 0, 0, 0, 68, 58, 92, 57, 48, 95, 115, 104, 101, 108, 108, 99, 111, 100, 101, 92, 82, 101, 108, 101, 97, 115, 101, 92, 115, 104, 101, 108, 108, 99, 111, 100, 101, 95, 102, 114, 97, 109, 101, 119, 111, 114, 107, 46, 112, 100, 98, 0, 0, 0, 0, 0, 3, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0 };

    ////PVOID *pShellcode = (PVOID *)shellcode;
    //memcpy_s(pMem, 1024 * 1024, shellcode, sizeof(shellcode));
    //HANDLE hThread = CreateThread(NULL, 0, (LPTHREAD_START_ROUTINE)pMem, NULL, 0, NULL);
    ////HANDLE hThread = CreateThread(NULL, 0, (LPTHREAD_START_ROUTINE)pShellcode, NULL, 0, NULL);
    //Sleep(INFINITE);
    
    
    unsigned char shellcode0[] =
    { 
        232, 0, 0, 0, 0, 94, 139, 254, 129, 198, 101, 5, 0, 0, 185, 8, 0, 0, 0, 252, 173, 1, 60, 7, 226, 250, 85, 139, 236, 131, 236, 20, 106, 0, 106, 0, 106, 0, 106, 0, 255, 21, 125, 2, 0, 0, 106, 0, 106, 0, 106, 0, 106, 0, 255, 21, 121, 2, 0, 0, 232, 106, 0, 0, 0, 137, 69, 252, 198, 69, 236, 77, 198, 69, 237, 101, 198, 69, 238, 115, 198, 69, 239, 115, 198, 69, 240, 97, 198, 69, 241, 103, 198, 69, 242, 101, 198, 69, 243, 66, 198, 69, 244, 111, 198, 69, 245, 120, 198, 69, 246, 65, 104, 193, 2, 0, 0, 255, 117, 252, 232, 199, 0, 0, 0, 89, 89, 137, 69, 248, 255, 53, 113, 2, 0, 0, 104, 93, 2, 0, 0, 104, 101, 2, 0, 0, 106, 0, 255, 85, 248, 15, 182, 5, 99, 2, 0, 0, 163, 109, 2, 0, 0, 51, 192, 139, 229, 93, 194, 4, 0, 85, 139, 236, 81, 83, 86, 87, 96, 100, 161, 48, 0, 0, 0, 137, 69, 252, 97, 139, 69, 252, 95, 94, 91, 139, 229, 93, 195, 85, 139, 236, 81, 81, 131, 101, 248, 0, 198, 69, 255, 1, 235, 7, 139, 69, 248, 64, 137, 69, 248, 139, 69, 8, 3, 69, 248, 15, 190, 0, 133, 192, 117, 15, 139, 69, 12, 3, 69, 248, 15, 190, 0, 133, 192, 117, 2, 235, 68, 139, 69, 8, 3, 69, 248, 15, 190, 0, 133, 192, 116, 47, 139, 69, 12, 3, 69, 248, 15, 190, 0, 133, 192, 116, 34, 139, 69, 8, 3, 69, 248, 15, 190, 0, 139, 77, 12, 3, 77, 248, 15, 190, 9, 59, 193, 117, 4, 235, 171, 235, 6, 198, 69, 255, 0, 235, 10, 235, 6, 198, 69, 255, 0, 235, 2, 235, 153, 138, 69, 255, 139, 229, 93, 195, 85, 139, 236, 131, 236, 60, 139, 69, 8, 137, 69, 224, 139, 69, 224, 139, 64, 12, 139, 64, 20, 137, 69, 228, 139, 69, 228, 137, 69, 236, 139, 69, 236, 131, 232, 8, 137, 69, 220, 139, 69, 236, 139, 0, 137, 69, 236, 139, 69, 220, 139, 64, 24, 137, 69, 248, 131, 125, 248, 0, 117, 5, 233, 187, 0, 0, 0, 139, 69, 248, 137, 69, 216, 139, 69, 216, 139, 77, 248, 3, 72, 60, 137, 77, 212, 106, 8, 88, 107, 192, 0, 139, 77, 212, 139, 68, 1, 120, 137, 69, 232, 131, 125, 232, 0, 117, 5, 233, 142, 0, 0, 0, 139, 69, 248, 3, 69, 232, 137, 69, 240, 139, 69, 240, 139, 77, 248, 3, 72, 12, 137, 77, 196, 139, 69, 240, 139, 77, 248, 3, 72, 32, 137, 77, 208, 131, 101, 244, 0, 235, 7, 139, 69, 244, 64, 137, 69, 244, 139, 69, 240, 139, 77, 244, 59, 72, 24, 115, 85, 139, 69, 244, 139, 77, 208, 139, 85, 248, 3, 20, 129, 137, 85, 204, 255, 117, 12, 255, 117, 204, 232, 192, 254, 255, 255, 89, 89, 15, 182, 192, 131, 248, 1, 117, 47, 139, 69, 240, 139, 77, 248, 3, 72, 36, 139, 69, 244, 102, 139, 4, 65, 102, 137, 69, 252, 139, 69, 240, 139, 77, 248, 3, 72, 28, 15, 183, 69, 252, 139, 4, 129, 137, 69, 200, 139, 69, 248, 3, 69, 200, 235, 16, 235, 153, 139, 69, 236, 59, 69, 228, 15, 133, 20, 255, 255, 255, 51, 192, 139, 229, 93, 195, 85, 139, 236, 106, 0, 232, 188, 253, 255, 255, 51, 192, 93, 195, 116, 105, 116, 108, 101, 0, 8, 0, 116, 101, 120, 116, 0, 0, 0, 0, 0, 240, 240, 240, 4, 0, 0, 0, 0, 0, 0, 0, 230, 253, 26, 117, 7, 254, 26, 117, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 229, 162, 202, 86, 0, 0, 0, 0, 2, 0, 0, 0, 72, 0, 0, 0, 84, 32, 0, 0, 84, 8, 0, 0, 0, 0, 0, 0, 229, 162, 202, 86, 0, 0, 0, 0, 12, 0, 0, 0, 20, 0, 0, 0, 156, 32, 0, 0, 156, 8, 0, 0, 77, 101, 115, 115, 97, 103, 101, 66, 111, 120, 65, 0, 82, 83, 68, 83, 53, 68, 51, 71, 103, 36, 76, 73, 166, 132, 159, 201, 189, 106, 68, 48, 1, 0, 0, 0, 68, 58, 92, 57, 48, 95, 115, 104, 101, 108, 108, 99, 111, 100, 101, 92, 82, 101, 108, 101, 97, 115, 101, 92, 115, 104, 101, 108, 108, 99, 111, 100, 101, 95, 102, 114, 97, 109, 101, 119, 111, 114, 107, 46, 112, 100, 98, 0, 0, 0, 0, 0, 3, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 216, 32, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 33, 0, 0, 0, 32, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 242, 32, 0, 0, 228, 32, 0, 0, 0, 0, 0, 0, 77, 2, 77, 101, 115, 115, 97, 103, 101, 66, 111, 120, 87, 0, 70, 2, 77, 101, 115, 115, 97, 103, 101, 66, 111, 120, 65, 0, 85, 83, 69, 82, 51, 50, 46, 100, 108, 108, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 24, 0, 0, 0, 24, 0, 0, 128, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 1, 0, 0, 0, 48, 0, 0, 128, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 9, 4, 0, 0, 72, 0, 0, 0, 96, 64, 0, 0, 125, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 60, 63, 120, 109, 108, 32, 118, 101, 114, 115, 105, 111, 110, 61, 39, 49, 46, 48, 39, 32, 101, 110, 99, 111, 100, 105, 110, 103, 61, 39, 85, 84, 70, 45, 56, 39, 32, 115, 116, 97, 110, 100, 97, 108, 111, 110, 101, 61, 39, 121, 101, 115, 39, 63, 62, 13, 10, 60, 97, 115, 115, 101, 109, 98, 108, 121, 32, 120, 109, 108, 110, 115, 61, 39, 117, 114, 110, 58, 115, 99, 104, 101, 109, 97, 115, 45, 109, 105, 99, 114, 111, 115, 111, 102, 116, 45, 99, 111, 109, 58, 97, 115, 109, 46, 118, 49, 39, 32, 109, 97, 110, 105, 102, 101, 115, 116, 86, 101, 114, 115, 105, 111, 110, 61, 39, 49, 46, 48, 39, 62, 13, 10, 32, 32, 60, 116, 114, 117, 115, 116, 73, 110, 102, 111, 32, 120, 109, 108, 110, 115, 61, 34, 117, 114, 110, 58, 115, 99, 104, 101, 109, 97, 115, 45, 109, 105, 99, 114, 111, 115, 111, 102, 116, 45, 99, 111, 109, 58, 97, 115, 109, 46, 118, 51, 34, 62, 13, 10, 32, 32, 32, 32, 60, 115, 101, 99, 117, 114, 105, 116, 121, 62, 13, 10, 32, 32, 32, 32, 32, 32, 60, 114, 101, 113, 117, 101, 115, 116, 101, 100, 80, 114, 105, 118, 105, 108, 101, 103, 101, 115, 62, 13, 10, 32, 32, 32, 32, 32, 32, 32, 32, 60, 114, 101, 113, 117, 101, 115, 116, 101, 100, 69, 120, 101, 99, 117, 116, 105, 111, 110, 76, 101, 118, 101, 108, 32, 108, 101, 118, 101, 108, 61, 39, 97, 115, 73, 110, 118, 111, 107, 101, 114, 39, 32, 117, 105, 65, 99, 99, 101, 115, 115, 61, 39, 102, 97, 108, 115, 101, 39, 32, 47, 62, 13, 10, 32, 32, 32, 32, 32, 32, 60, 47, 114, 101, 113, 117, 101, 115, 116, 101, 100, 80, 114, 105, 118, 105, 108, 101, 103, 101, 115, 62, 13, 10, 32, 32, 32, 32, 60, 47, 115, 101, 99, 117, 114, 105, 116, 121, 62, 13, 10, 32, 32, 60, 47, 116, 114, 117, 115, 116, 73, 110, 102, 111, 62, 13, 10, 60, 47, 97, 115, 115, 101, 109, 98, 108, 121, 62, 13, 10, 0, 0, 0, 37, 0, 0, 0, 51, 0, 0, 0, 108, 0, 0, 0, 127, 0, 0, 0, 132, 0, 0, 0, 137, 0, 0, 0, 149, 0, 0, 0, 154, 0, 0, 0
         };
    //PVOID *pShellcode = (PVOID *)shellcode;
    memcpy_s(pMem, 1024*1024, shellcode0, sizeof(shellcode0));
    HANDLE hThread0 = CreateThread(NULL, 0, (LPTHREAD_START_ROUTINE)pMem, NULL, 0, NULL);
    //HANDLE hThread = CreateThread(NULL, 0, (LPTHREAD_START_ROUTINE)pShellcode, NULL, 0, NULL);
    Sleep(INFINITE);
    return 0;
}
